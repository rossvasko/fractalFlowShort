% ---------------------------------------------------------------------------
% Author guideline and sample document for EG publication using LaTeX2e input
% D.Fellner, v1.13, Jul 31, 2008

\documentclass{egpubl}
\usepackage{eurovis2016}

% --- for  Annual CONFERENCE
% \ConferenceSubmission   % uncomment for Conference submission
% \ConferencePaper        % uncomment for (final) Conference Paper
% \STAR                   % uncomment for STAR contribution
% \Tutorial               % uncomment for Tutorial contribution
% \ShortPresentation      % uncomment for (final) Short Conference Presentation
% \Areas                  % uncomment for Areas contribution
% \MedicalPrize           % uncomment for Medical Prize contribution
% \Education              % uncomment for Education contribution
%
% --- for  CGF Journal
% \JournalSubmission    % uncomment for submission to Computer Graphics Forum
% \JournalPaper         % uncomment for final version of Journal Paper
%
% --- for  CGF Journal: special issue
% \SpecialIssueSubmission    % uncomment for submission to Computer Graphics Forum, special issue
\SpecialIssuePaper         % uncomment for final version of Journal Paper, special issue
%
% --- for  EG Workshop Proceedings
% \WsSubmission    % uncomment for submission to EG Workshop
% \WsPaper         % uncomment for final version of EG Workshop contribution
%
 \electronicVersion % can be used both for the printed and electronic version

% !! *please* don't change anything above
% !! unless you REALLY know what you are doing
% ------------------------------------------------------------------------

% for including postscript figures
% mind: package option 'draft' will replace PS figure by a filname within a frame
\ifpdf \usepackage[pdftex]{graphicx} \pdfcompresslevel=9
\else \usepackage[dvips]{graphicx} \fi

\PrintedOrElectronic

% prepare for electronic version of your document
\usepackage{t1enc,dfadobe}

\usepackage{egweblnk}
\usepackage{cite}

% For backwards compatibility to old LaTeX type font selection.
% Uncomment if your document adheres to LaTeX2e recommendations.
% \let\rm=\rmfamily    \let\sf=\sffamily    \let\tt=\ttfamily
% \let\it=\itshape     \let\sl=\slshape     \let\sc=\scshape
% \let\bf=\bfseries

% end of prologue

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\documentclass[review,journal]{vgtc}          % review (journal style)
%\documentclass[widereview]{vgtc}             % wide-spaced review
%\documentclass[preprint,journal]{vgtc}       % preprint (journal style)
%\documentclass[electronic,journal]{vgtc}     % electronic version, journal
\let\ifpdf\relax

%% Uncomment one of the lines above depending on where your paper is
%% in the conference process. ``review'' and ``widereview'' are for review
%% submission, ``preprint'' is for pre-publication, and the final version
%% doesn't use a specific qualifier. Further, ``electronic'' includes
%% hyperreferences for more convenient online viewing.

%% Please use one of the ``review'' options in combination with the
%% assigned online id (see below) ONLY if your paper uses a double blind
%% review process. Some conferences, like IEEE Vis and InfoVis, have NOT
%% in the past.

%% Please note that the use of figures other than the optional teaser is not permitted on the first page
%% of the journal version.  Figures should begin on the second page and be
%% in CMYK or Grey scale format, otherwise, colour shifting may occur
%% during the printing process.  Papers submitted with figures other than the optional teaser on the
%% first page will be refused.

%% These three lines bring in essential packages: ``mathptmx'' for Type 1
%% typefaces, ``graphicx'' for inclusion of EPS figures. and ``times''
%% for proper handling of the times font family.

% Math-mode symbol & verbatim
\def\W#1#2{$#1{#2}$ &\tt\string#1\string{#2\string}}
\def\X#1{$#1$ &\tt\string#1}
\def\Y#1{$\big#1$ &\tt\string#1}
\def\Z#1{\tt\string#1}

\usepackage{mathptmx}
%%\usepackage{psfrag}
\usepackage{graphicx}
\usepackage{times}
\usepackage{epstopdf}

%\usepackage{amssymb,amsmath,amsthm}
\usepackage{amssymb,amsmath}
\usepackage[lined,linesnumbered]{algorithm2e}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{framed}
\usepackage{tikz}
%\usepackage{array}

\usepackage{float}

\usepackage{varwidth}

%% We encourage the use of mathptmx for consistent usage of times font
%% throughout the proceedings. However, if you encounter conflicts
%% with other math-related packages, you may want to disable it.

%% This turns references into clickable hyperlinks.
%%\usepackage[bookmarks,backref=true,linkcolor=black]{hyperref} %,colorlinks
%% \hypersetup{
%%  pdfauthor = {},
%%  pdftitle = {},
%%  pdfsubject = {},
%%  pdfkeywords = {},
%%  colorlinks=true,
%%  linkcolor= black,
%%  citecolor= black,
%%  pageanchor=true,
%%  urlcolor = black,
%%  plainpages = false,
%%  linktocpage
%%}

%% If you are submitting a paper to a conference for review with a double
%% blind reviewing process, please replace the value ``0'' below with your
%% OnlineID. Otherwise, you may safely leave it at ``0''.
%%\onlineid{0}

%% declare the category of your paper, only shown in review mode
%%\vgtccategory{Technique}

%% allow for this line if you want the electronic option to work properly
%%\vgtcinsertpkg

%% In preprint mode you may define your own headline.
%\preprinttext{To appear in an IEEE VGTC sponsored conference.}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Math commands
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand {\emath}[1]  {\ensuremath{#1}}
\newcommand {\R}         {\emath{\mathbb{R}}}        % Real space
\newcommand {\Real}[1]   {\emath{\mathbb{R}^{#1}}}   % Real space
\newcommand {\Rd}        {\Real{d}}                  % R^d
\newcommand {\Rdone}     {\Real{d+1}}                % R^d+1
\newcommand {\Rk}        {\Real{k}}                  % R^k
\newcommand {\Rtwo}      {\Real{2}}                  % R^2
\newcommand {\Rthree}    {\Real{3}}                  % R^3
\newcommand {\Rfour}     {\Real{4}}                  % R^4
\newcommand {\Sphere}[1] {\emath{\mathbb{S}^{#1}}}   % Sphere
\newcommand {\Sk}        {\Sphere{k}}                % S^k
\newcommand {\Sd}        {\Sphere{d}}                % S^d
\newcommand {\BB}        {\emath{\mathbb{B}}}        % B
\newcommand {\Ball}[1]   {\emath{\mathbb{B}^{#1}}}   % B^{#1}
\newcommand {\Ballep}    {\emath{B^{\epsilon}_{p}}}  % B^e_p
\newcommand {\cl}        {\emath{\mathrm{cl}}}       % cl
\newcommand {\cb}        {\emath{\mathbf{c}}}        % bold c
\newcommand {\eb}        {\emath{\mathbf{c}}}        % bold e
\newcommand {\tpi}       {\emath{\tilde{\pi}}}       % \pi~
\newcommand {\gDim}[1]   {\emath{#1 \times #1 \times #1}} % DxDxD

\newcommand {\tg}        {\emath{\tilde{g}}}
\newcommand {\tn}        {\emath{\tilde{n}}}
\newcommand {\IV}        {\emath{\mathcal{I_V}}}
\newcommand {\Orth}      {\emath{\mathcal{O}}}
\newcommand {\hN}        {\emath{\widehat{N}}}
\newcommand {\XX}        {\emath{\mathcal{X}}}

\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}[proposition]
\newtheorem{lemma}[proposition]{Lemma}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% tikz block styles
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usetikzlibrary{shapes,arrows}

\tikzstyle{action} = [rectangle, draw, text centered, node distance=4cm, minimum height=4em]
\tikzstyle{source} = [draw, ellipse, text centered, node distance=1.5cm, minimum height=4em, text width=3cm]
\tikzstyle{sink} = [draw, ellipse, text centered, node distance=2cm, minimum height=4em]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{figlabel} = [text centered, node distance=1.5cm, text width=1cm]

% Define block styles
\tikzstyle{decision} = [diamond, draw, fill=white!20, text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw,thick,fill=blue!0, text centered, rounded corners, minimum height=1em]
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=3cm,minimum height=2em]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% algorithm2e keywords and commands
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% algorithm2e global keywords
\SetKw{Function}{Function}
\SetKw{true}{true}
\SetKw{false}{false}
\SetKw{KwAnd}{and}
\SetKw{KwOr}{or}
\SetKw{true}{true}
\SetKw{false}{false}
\SetKw{KwElse}{else}
\SetKw{KwDownTo}{downto}
\SetKwData{NULL}{NULL}
\SetKwInOut{Input}{Input}
\SetKwInOut{Output}{Output}
\SetKwInOut{Result}{Result}
\SetKwInOut{Requires}{Requires}
\ResetInOut{Requires1}
\SetKwComment{NoLineNum}{}{}
\SetCommentSty{textit}
\SetArgSty{textrm}
\SetFuncSty{textsc}
\SetAlgoLined

\IncMargin{1ex}

\SetKwFunction{AngleTest}{AngleTest}
\SetKwFunction{ScalarTest}{ScalarTest}
\SetKwFunction{ReliableGrad}{ReliableGrad}
\SetKwFunction{MergeSharp}{MergeSharp}
\SetKwFunction{FindSharp}{FindSharp}
\SetKwFunction{CountDegree}{CountDegree}
\SetKwFunction{SelectiveFindSharp}{SelectiveFindSharp}
\SetKwFunction{Magnitude}{Magnitude}
\SetKwFunction{Angle}{Angle}
\SetKwFunction{Distance}{Distance}
\SetKwData{Grid}{Grid}
\SetKwData{numAgree}{numAgree}
\SetKwData{errorDist}{errorDist}
\SetKwData{maxErrorDist}{maxErrorDist}
\SetKwData{numIter}{numIter}

% Algorithm function names and variables
\SetKwFunction{DoesOrthMatch}{DoesOrthMatch}
\SetKwFunction{DoesOrthMatchA}{DoesOrthMatchA}
\SetKwFunction{DoesOrthMatchB}{DoesOrthMatchB}
\SetKwFunction{ExtendReliable}{ExtendReliable}


\SetKwData{Center}{Center}
\SetKwData{Centroid}{Centroid}
\SetKwData{isovLoc}{isovLoc}
\SetKwData{numLargeEigenvalues}{numLargeEigenvalues}

% algorithm2e reset line number
\newcommand {\ResetAlgoLineNumber} {\setcounter{AlgoLine}{0}}

\SetAlgoCaptionSeparator{.}


\title{Visualizing Flow Fields Using Fractal Dimensions}

%% This is how authors are specified in the journal style

\author[Han-Wei Shen, Ross Vasko, \& Rephael Wenger]
	{Han-Wei Shen, Ross Vasko, and Rephael Wenger
	\\
	The Ohio State University, Columbus, OH, USA
	}



\begin{document}

\maketitle

\begin{abstract}
Streamlines are a popular way of visualizing flow in vector fields.
A major challenge in streamline visualization is selecting the streamlines for visualization.
Rendering too many streamlines clutters the visualization and makes features of the field difficult to identify. 
Rending too few streamlines causes viewers to completely miss features of the flow field not rendered. 

The fractal dimension of a streamline represents its space-filling properties.
To identify complex or interesting streamlines, we build a regular grid of scalar values which represent the fractal dimension of streamlines around each grid vertex.
High fractal dimension indicates vortices or turbulent regions.
We use this scalar grid both to filter streamlines by fractal dimension and to identify and visualize regions containing vortices and turbulence.
We describe an interactive tool which allows for quick streamline selection and visualization of regions containing vortices and turbulence.
\\
\begin{classification}
\CCScat{Computer Graphics}{I.3.3}{Picture/Image Generation}{Line and curve generation}
\end{classification}

\end{abstract}

%% Keywords that describe your work. Will show as 'Index Terms' in journal
%% please capitalize first letter and insert punctuation after last keyword
%\keywords{Streamlines, fractal dimension.}

%% ACM Computing Classification System (CCS). 
%% See <http://www.acm.org/class/1998/> for details.
%% The ``\CCScat'' command takes four arguments.

%%\CCScatlist{ % not used in journal version
%%\CCScat{I.3.5}{Computer Graphics}{Computational Geometry and Object Modeling}
%%}

%% Uncomment below to include a teaser figure.
%\teaser{
%}

%% Uncomment below to disable the manuscript note
%\renewcommand{\manuscriptnotetxt}{}

%% Copyright space is enabled by default as required by guidelines.
%% It is disabled by the 'review' option or via the following command:
% \nocopyrightspace

\renewcommand{\textfraction}{0.2}
\renewcommand{\dbltopfraction}{0.8}	
\renewcommand{\topfraction}{0.8}	


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% START OF THE PAPER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\maketitle

\section{Introduction}

A vector field in 3D is a map $f: \Rthree \Rightarrow \Rthree$.
A flow field is a specific type of vector field that represents the flow of some fluid.
Each point in a flow field is a vector that represents the direction and rate of mass transport of a flow.
Flow fields are used in several different fields of science and engineering.
They can be used to model large scale simulations such as atomospheric behavior, air flow during wind tunnel tests, or blood flow.
Flow field data sets contain several different features, such as vortices, and have regions with different types of flow behavior.
Visualizing these different regions and features is crucial to understanding the flow data.

A common way to visualize flow fields is with streamlines.
A streamline is a curve that is tangent to the velocity vector of the flow field at each point of the curve.
Streamlines are computationally inexpensive to generate and allow a viewer to see the behavior of a region of the flow field.
A large challenge in using streamlines to visualize flow fields is choosing which streamlines to display to both prevent cluttering the visualization as well as ensuring a proper sampling of the flow field.

To appropriately filter the streamlines and identify important flow field features, we examine the geometric properties of streamlines using the box-counting ratio defined by Khoury and Wenger.
The box-counting ratio measures the space-filling properties of an object and quantifies its complexity.
With this measurement, we are then able to categorize streamlines based on their complexity.
Such a measurement allows for filtering to remove clutter while still retaining important or defining flow field features.
Additionally, this measurement allows for not only complexity measurements to be assigned to the streamlines, but also to the flow field itself.
We construct a scalar grid with values that are representative of the complexity of the streamlines in some nearby neighborhood.
This scalar field allows us to easily identify which regions of the flow field are complex.
Lastly, we apply a variety of interactive visualization techniques to the scalar field to allow the user different insights on the flow data.

\section{Related Work}

There has already been a considerable amount of work done in streamline filtering and flow field feature identification, but many of these methods require prerequiste knowledge of the flow field or depend on restrictive definitions of features.
Streamline seeding in 2D or on surfaces in 3D is discussed in \cite{turk}, \cite{mao}, and \cite{mebarki}.
While these techniques create clear and evenly spaced streamlines visualizations for surfaces, they are difficult to extend into a general 3D space.

McLoughlin et al. \cite{mcloughlin} seek to reduce streamline clutter by requiring a predefined rake and then removing streamlines along that rake that exhibit significant amounts of similarity to reduce redundancy and clutter.
View points of streamlines are evaluated in \cite{marchesin} by analyzing the amount of occlusion present in a viewpoint.
Streamline methods based on concepts of entropy are discussed in \cite{shen} and \cite{lee}.

Critical points of the flow field are analyzed in \cite{ye} and different seeding strategies are used depending on the behavior near the critical points.
In \cite{salzbrunn}, various definitions are constructed for different flow field features and the features are searched for in the flow field.
Similarly, various features such as vortices are defined in \cite{heiberg} and the vectors of the flow field are examined to see if they meet requirements of the properties.
In all \cite{sadarjoen1999}, \cite{sadarjoen1998}, and \cite{zhong} features of a vortex are defined and then searched for in the flow field.
\cite{mahrous} does segment the flow field generally, but this method does not supply a way of quantifying the complexity of flow field regions.

We attempt to avoid any strict definition of flow field features to prevent restricting our algorithm to only find specific features.
Instead, we treat the complexity of a streamline as how it fills a space.
In a previous work by Chaudhuri et al. \cite{chaudhuri}, he introduces measuring the streamline complexity with fractal dimensions to observe behavior at different scales.
Fractal dimensions are further discuessed in \cite{khoury}.
Features in the flow field can then be organized by their complexity as well as what scale the feature appears in.
Using the box counting ratio, we are able to both have a general definition of complexity and provide scalar values that are representative of the flow field complexity.

\section{Box Counting Ratio} \label{sec:bcr}

Khoury and Wenger \cite{khoury} defined a box counting ratio approximation based on fractal dimensions in a previous work on examining properties of isosurfaces using fractal dimensions.
Depending on how a set fills a space, the calculated box counting ratio of the set is a real number between 0 and 3 for a space filling fractal in 3D.
The box counting ratio of a set S is defined as:
\begin{equation} dim_{\epsilon}(S) = \log_2\frac{N_{\epsilon}(S)}{N_{2\epsilon}(S)}\end{equation}
where $N_{x}(S)$ is the number of boxes that the set $S$ will intersect on a fixed grid that has boxes with edge lengths of $x$.

We then measure the box counting ratio of the streamlines by defining a fixed grid, counting the number of boxes of widths $\frac{\epsilon}{2}$ and ${\epsilon}$ that a streamline intersects, and then solving for the final box counting dimension.
With this new formula, we expect that the straight and simple streamlines will have a fractal dimension near 1, as they do not have any space filling properties.
As the streamline becomes more complex and fills a 3D region more densely, we expect the fractal dimension to increase towards 3.
These measurements are illustrated in 2D examples in Figure \ref{fig:box_counting_calcs}

\begin{figure}[h]
        \centering
                \begin{minipage}{0.49\linewidth}
                        \small \centering
                        \includegraphics[height = .95\linewidth]{Images/line.png} \\ (a) simple streamline
                \end{minipage}
                \begin{minipage}{0.49\linewidth}
                        \small \centering
                        \includegraphics[height = .95\linewidth]{Images/spiral.jpg} \\ (b) complex streamline
                \end{minipage}
        \caption{Examples of the box counting ratio measuring streamline complexity in 2D. (a) is calculated to have a box counting ratio of  $\log_2\frac{12}{5} = 1.26$ while the more complex line (b) is calculated to have a box counting ratio of $\log_2\frac{29}{8} = 1.86$.}
        \label{fig:box_counting_calcs}
\end{figure}

\section{Streamline Complexity Grid} \label{sec:scg}

The streamline complexity grid, $\phi : \Rthree \Rightarrow \R$, is a scalar grid on top of an input flow field with a spacing of $2l$ between each point. 
Each scalar value quantifies the complexity of the flow behavior in a region near each point using the local box-counting ratio.

The local box-counting ratio only considers a portion of the streamline to better capture features along the streamline and is calculated in the following manner.
Let $\zeta$ be a streamline generated from the flow field and let $B_{p}$ be a cube centered at point $p$ with edge lengths $4l \dot w$.
Then the local box-counting ratio of $\zeta$ at $p$ is $dim_{w}(\zeta \cap B_{p})$.
Additionally, if the value $N_{w}(\zeta \cap B_{p})$ during the local box-counting ratio is below a cutoff $c$, then we discard this measurement.
We implement this cutoff to ensure that enough of a streamline is being examined to calculate a stable measurement.

To generate the values for the streamline complexity grid, streamlines must be generated to properly sample the vector field.
Streamlines are generated in a manner so that each grid voxel has at least five streamlines intersecting it that also meet the required cutoff in the local box-counting ratio calculation.
For each grid point $p$ and generate a new streamline $\zeta_{p}$ if the voxel $v_{p}$ does not meet the previous requirement.
If streamline $\zeta_{p}$ was generated from $p$, find all voxels $v_{q}$ that $\zeta_{p}$ intersects.
If $\zeta_{p}$ meets the cutoff requirement and less than five streamlines have not yet been stored for $v_p$, store $\zeta_p$ as one of the streamlines for $v_p$.
At the end of this process, each voxel in the streamline complexity grid will be associated with five streamlines that intersect it.
(This is not always true in some extreme cases. Should I discuss what happens if no streamlines can be stored for a voxel?)

To calculate the final value $\phi(p)$, take the five streamlines associated with $v_{p}$ and calculate the local box-counting ratio of each streamlines at $p$ and record the median value.
Additionally, discard all other streamlines associated with voxel $v_p$ other than the streamline whose local box-counting ratio at $p$ was the median value.
Let this streamline be denoted as $p_{\zeta}$.
The streamline complexity grid is filtered by averaging each point with its 26 neighbors.

%In addition to each grid point being assigned a complexity value, each streamline is assigned a complexity value.
%The complexity value of a streamline $\zeta$ is recorded as the high local box-counting ratio calculated from that streamline and is denoted as $\psi(\zeta)$.

The streamline complexity computations can be used in a variety of ways to filter streamlines of varying complexities or to provide a method of visualization for the flow field.

\section{Visualization Methods}

Once constructed, the streamline complexity grid can be used in visualization techniques.
We describe the different techniques that are possible with the streamline complexity grid.

\subsection{Streamline filtering by value}
To remove streamlines in the flow field and to reduce clutter, the user can filter streamlines by their measured complexity value.
The user is able to choose two values, $a$ and $b$ where $a < b$, and only display streamlines from voxels with a complexity between the chosen values. 
The streamline $p_{\zeta}$ will be displayed only if $a \leq \phi(p) \leq b$.
The constants allow the user to choose the level of streamline complexity that they will view.
By choosing constants of values near 1, streamlines with a low box counting ratio and smooth flow will be displayed.
By choosing constants of values above 1, streamlines will begin to be filtered and the more complex regions of the flow field are highlighted.
Filtering by complexity value is shown in Figure \ref{fig:value_filter}

\begin{figure}[h]
        \centering
                \begin{minipage}{0.30\linewidth}
                        \small \centering
                       	\includegraphics[height = 1.05\linewidth]{Images/all_equation.png}\\(a)
                \end{minipage}
                \begin{minipage}{0.30\linewidth}
                        \small \centering
                        \includegraphics[height = 1.05\linewidth]{Images/filter_equation.png}\\(b)
                \end{minipage}
                \begin{minipage}{0.30\linewidth}
                        \small \centering
                        \includegraphics[height = 1.05\linewidth]{Images/max_equation.png}\\(c)
                \end{minipage}
        \caption{Example of the streamline filtering techniques. (a) contains the clutter view of all 5000 streamlines generated. (b) filters streamlines below a certain complexity value to only display 110 streamlines. (c)  filters streamlines by local maximums to show 8 streamlines.}
        \label{fig:value_filter}
\end{figure}

\subsection{Local complexity maximums}
A significant amount of clutter in the streamline display will remain if additional filtering methods are not considered.
Several streamlines in the visualization will be visually similar or provide redundant information.
We are able to only show the local maximum streamlines to filter streamlines that all represent a single region or feature of the flow.
Local maximum filtering will show streamline $p_\zeta$ at point  $p$ only if for each $q$, where $q$ is one of the 8 neighbors of $p$, $\phi(v) > \phi(q)$.
This method allows for single streamlines representatives to be shown for each feature or region rather than several, cluttered streamlines.

\subsection{Complexity plane}
A colored plane can be used to allow the user to visualize the scalar complexity grid, $\phi$, directly.
A color gradient from blue to white to red is able to be defined and mapped to values in the range 0 to 3, for each of the possible box counting dimensions ratios.
Low scalar values will be displayed as blue colors, while high scalar values will be displayed as red colors.
A plane is then defined on the scalar complexity grid and each point on the plane is colored from this defined color gradient.
The user is able to control the plane through the scalar complexity grid to identify regions varying complexity in the grid.
Once regions of interest are identified through the colored plane, the user can display streamlines near that region to understand its behavior.
Additionally, streamlines seeded from the plane are able to be visualized.
The user is able to view different ratios of both high complexity and low complexity streamlines seeded from the plane.
An example of the plane visualizations are shown in Figure \ref{fig:plane}.

\begin{figure}[h]
        \centering
                \begin{minipage}{0.45\linewidth}
                        \small \centering
                        \includegraphics[height = 1\linewidth]{Images/plane_equation.png}\\(a)
                \end{minipage}
                \begin{minipage}{0.45\linewidth}
                        \small \centering
                        \includegraphics[height = 1\linewidth]{Images/plane_equation_lines.png}\\(b)
                \end{minipage}
        \caption{Example visualizations using the colored plane. (a) contains the plane indicating the regions of high complexity. (b) contains the high complexity lines near the defined plane.}
        \label{fig:plane}
\end{figure}

\subsection{Isosurfaces:} 
An isosurface can be used to highlight regions of the flow field with a high complexity.
An isosurface, which is defined by
\begin{equation} \{ x \mid \phi(x) = \sigma \}\end{equation}
where $\sigma$ is the isovalue and $\phi$ is the streamline complexity field, will separate all scalar values above $\sigma$ from the values below $\sigma$ on the streamlines complexity.
This isosurface will enclose the regions of streamlines with a fractal dimension higher than the $\sigma$ value and provide a simple way to identify regions of a defined complexity.
At particularly high $\sigma$ values, the isosurface will only enclose vortices and turbulent features of the flow field that the user may have otherwise missed.

\subsection{Streamline gradient magnitudes:}
The gradient magnitudes of the streamline complexity grid can be calculated to create a new gradient magnitude scalar grid $\phi_g$.
The scalar $\phi_g(x)$ is given by $\| \nabla \phi(x) \|$.
Another isosurface can be used to visualization the function $\phi_g$ to identify regions of high change of turbulence or complexity.
Vortices in the flow field tend to have high complexity values recorded near their centers, with values quickly decreasing towards their boundaries.
When a high isovalue is chosen for the gradient magnitude isosurface's isovalue, the isosurface will highlight these isolated regions of turbulence or turbulent regions that quickly become smooth.
Example of isosurfaces of the scalar complexity values and gradient magnitudes are shown in Figure \ref{fig:iso}.

\begin{figure}[h]
        \centering
                \begin{minipage}{0.47\linewidth}
                        \small \centering
                        \includegraphics[height = 1\linewidth]{Images/iso_equation.png}\\(a)
                \end{minipage}
                \begin{minipage}{0.47\linewidth}
                        \small \centering
                        \includegraphics[height = 1\linewidth]{Images/grad_iso_equation.png}\\(b)
                \end{minipage}
        \caption{Example visualizations with isosurfaces. (a) contains the scalar value isosurface enclosing high complexity regions. (b) contains the gradient isosurface enclosing regions of high complexity change.}
        \label{fig:iso}
\end{figure}

\section{Results} \label{sec:examples}

In this section we will demonstrate how the previously described techniques can enhance the visualization of large flow field data sets.
Explanations and figures are given to show the advantages and features given by our algorithms.

The algorithm was implemented in C++ using The Visualization Toolkit (VTK) across two separate programs.
The first program has been created to generate streamlines, compute complexity measurements, and compute the streamline complexity grid and then output this information.
Then another program takes the output files as input and allows the user to interact with the streamlines and the streamline complexity grid in real-time.

The previously described algorithms and techniques are applied to the Solar Plume data set.
The Solar Plume data is a $126 \times 126 \times 512$ vector field data set.
This data set has many different regions of varying flow complexity.
Central regions of the flow tend to be more laminar with vortices near the boundaries of the data set.
These regions are able to be identified and highlighted by our algorithm.

A filtering of the streamlines produced by considering the complexity measurements of the streamline given by our algorithm along with isosurfaces is displayed in Fig. \ref{fig:plume_lines}.a.
The filtering drastically reduces the clutter in the visualization and makes the regions of interest much more clear to the user.
The streamlines are also colored by complexity, with the red streamlines being the most complex and often contain vortices and green streamlines being less complex.
The aqua isosurface in this rendering is set to a value near ???1.3??? to enclose the complex regions of the line.
Additionally, the purple isosurface is the gradient isosurfaces and highlights regions around vortices that have a high change in complexity.

A plane with nearby streamlines is shown in Fig. \ref{fig:plume_lines}.b.
The colored plane allows the viewer to see that the Solar Plume consists of a mostly smooth behavior towards its center and then becomes more turbulent near to edges.
Rather than manually attempting to identify which regions of the flow field exhibit specific types of behavior, this visualization allows the viewer to identify these regions quickly.

\begin{figure}[h]
        \centering
               	\begin{minipage}{0.47\linewidth}
                      	\centering \small
                        \includegraphics[height = 2\linewidth]{Images/plume_iso.png}\\(a) Solar Plume filtered
                \end{minipage}
                \begin{minipage}{0.47\linewidth}
                        \centering \small
                        \includegraphics[height = 2\linewidth]{Images/plume_plane.png}\\(a) Solar Plume with plane
                \end{minipage}
        \caption{Example of how filtering increases the visibility of flow field features in the Solar Plume data set. (a) displays the set of streamlines filtered by complexity measurements from an original data set. In (b), the plane allows the viewer to see the different regions of high and low complexity.}
        \label{fig:plume_lines}
\end{figure}

\section{Summary}

In this paper we proposed a method of filtering streamlines and identifying complex regions of the flow field.
We described a method of quantifying flow field complexity by measuring the box-counting ratio of streamlines seeded from the flow field.
Then using this box-counting dimension, we are able to make a streamline complexity grid that has scalar values to represent the complexities of different regions.
The streamline complexity grid along with the streamline box counting dimensions allow for many visualization techniques such as filtering by local maximums and isosurfaces to allow the viewer to identify interesting parts of a flow field.
We then applied these filtering methods and visualization techniques to a data set and showed how they created a quality visualization.


\clearpage
%\bibliographystyle{eg-alpha}
\bibliography{fractalFlow}
\bibliographystyle{eg-alpha-doi}


\end{document}
